function AjaxErrorHandler(n,t){Loading(!1);switch(n){case 0:$("#form-disconnected-main").text("您目前未連上網路僅提供離線資料，");$("#form-disconnected-msg").text("請檢查行動網路/WiFi是否正常連接。");$("#form-app").show();$("#form-disconnected").show();break;case 401:$("#form-app").hide();return;default:alert(n+"系統發生錯誤："+t)}}function DetectOnLine(){navigator.onLine===!1?AjaxErrorHandler(0,null,null):$("#form-disconnected").hide();setTimeout(DetectOnLine,5e3)}function Init(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker-1.0.1.min.js").then(n=>{registration=n,InitNoticeUI()})});sessionStorage.Page===undefined&&(sessionStorage.Page=MENU1);DetectOnLine();SwitchPage()}function InitNoticeUI(){registration!==null&&"PushManager"in window&&registration.pushManager.getSubscription().then(function(n){isSubscribed=!(n===null);SubscribeNotice()})}function IsNull(n){return n===null||typeof n=="undefined"||n===""||n==="null"}function Loading(n){switch(n){case!0:$(".loader").fadeIn(300);break;default:$(".loader").fadeOut(300)}}function RefreshApp(){caches.keys().then(function(n){$.map(n,function(){caches.delete(name)})});registration.update();location.reload()}function SwitchPage(){let n=$(".js-pageName");$(".js-menu-item").removeClass("active");$(".js-container-content").removeClass("active");switch(sessionStorage.Page){case MENU1:n.text("首頁");break;case MENU2:n.text("PWA 介紹");break;case MENU3:n.text("Slot 遊戲");break;case MENU4:n.text("Wheel 遊戲");break;case MENU5:n.text("Poker 遊戲")}$('.js-menu-item[data-target="'+sessionStorage.Page+'"]').addClass("active");$('.js-container-content[data-trigger="'+sessionStorage.Page+'"]').addClass("active");$(".js-side-nav").removeClass("visible")}function SubscribeNotice(){registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:UrlB64ToUint8Array(applicationServerPublicKey)}).then(function(){isSubscribed=!0;UpdateSubscribe()}).catch(function(){UpdateSubscribe()})}function UpdateSubscribe(){isSubscribed?$("#btn-openNotice").addClass("invisible"):$("#btn-openNotice").removeClass("invisible")}function UrlB64ToUint8Array(n){const u="=".repeat((4-n.length%4)%4),f=(n+u).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(f),r=new Uint8Array(i.length);for(var t=0;t<i.length;++t)r[t]=i.charCodeAt(t);return r}const MENU1="Welcome",MENU2="Intro",MENU3="Slot",MENU4="Wheel",MENU5="Poker",applicationServerPublicKey="BPKG6mdbOcsA_m_g4CUnEuVIQQhAm4KwJv3Hp8xCvy37VSDRURlROvw9QyS8Sr98Q-A_m3aexKy7ucUFaaR_jNA";let registration=null,isSubscribed=null;Init();$("#btn-refresh").click(function(){RefreshApp()});$("#btn-openNotice").click(function(){InitNoticeUI()});$(".js-menu-item").click(function(){sessionStorage.Page=$(this).data("target");SwitchPage()});$(".js-navbar-toggler").click(function(){$(".js-side-nav").toggleClass("visible")});$(".js-side-nav").click(function(){$(event.target).hasClass("visible")===!0&&$(".js-side-nav").toggleClass("visible")});